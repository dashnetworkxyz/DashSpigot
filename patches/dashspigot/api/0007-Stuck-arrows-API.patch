From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: MasterDash5 <constant4337@molecularmail.com>
Date: Sun, 2 Nov 2025 15:37:20 -0700
Subject: [PATCH] Stuck arrows API


diff --git a/src/main/java/org/bukkit/entity/LivingEntity.java b/src/main/java/org/bukkit/entity/LivingEntity.java
index 48e2508941299ce55f672979ff85a2969fc1c64b..b146b2888ea8eec2a58b94248b8814543c8c6d6c 100644
--- a/src/main/java/org/bukkit/entity/LivingEntity.java
+++ b/src/main/java/org/bukkit/entity/LivingEntity.java
@@ -392,4 +392,90 @@ public interface LivingEntity extends Entity, Damageable, ProjectileSource {
      * @return whether the operation was successful
      */
     public boolean setLeashHolder(Entity holder);
+
+    // DashSpigot start - Stuck arrows API
+    /**
+     * Gets the time in ticks until the next arrow leaves the entity's body.
+     *
+     * @return ticks until arrow leaves
+     */
+    public int getArrowCooldown();
+
+    /**
+     * Sets the time in ticks until the next arrow leaves the entity's body.
+     * <p>
+     * A value of 0 will cause the server to re-calculate the time on the
+     * next tick.
+     *
+     * @param ticks time until arrow leaves
+     */
+    public void setArrowCooldown(int ticks);
+
+    /**
+     * Gets the amount of ticks before the next arrow gets removed from the
+     * entities body.
+     *
+     * @return Amount of ticks
+     */
+    default int getNextArrowRemoval() {
+        return getArrowCooldown();
+    }
+
+    /**
+     * Sets the amount of ticks before the next arrow gets removed from the
+     * entities body.
+     * <p>
+     * A value of 0 will cause the server to re-calculate the amount of ticks
+     * on the next tick.
+     *
+     * @param ticks Amount of ticks
+     */
+    default void setNextArrowRemoval(int ticks) {
+        setArrowCooldown(ticks);
+    }
+
+    /**
+     * Gets the amount of arrows in an entity's body.
+     *
+     * @return amount of arrows in body
+     */
+    public int getArrowsInBody();
+
+    /**
+     * Set the amount of arrows in the entity's body.
+     * <p>
+     * Does not fire the {@link org.bukkit.event.entity.ArrowBodyCountChangeEvent}.
+     *
+     * @param count amount of arrows in entity's body
+     */
+    default void setArrowsInBody(int count) {
+        setArrowsInBody(count, false);
+    }
+
+    /**
+     * Set the amount of arrows in the entity's body.
+     *
+     * @param count amount of arrows in entity's body
+     * @param fireEvent whether to fire the {@link org.bukkit.event.entity.ArrowBodyCountChangeEvent} event
+     */
+    public void setArrowsInBody(int count, boolean fireEvent);
+
+    /**
+     * Get the number of arrows stuck in this entity
+     *
+     * @return Number of arrows stuck
+     */
+    default int getArrowsStuck() {
+        return getArrowsInBody();
+    }
+
+    /**
+     * Set the number of arrows stuck in this entity
+     *
+     * @param arrows Number of arrows to stick in this entity
+     */
+    default void setArrowsStuck(int arrows) {
+        setArrowsInBody(arrows);
+    }
+    // DashSpigot end
 }
diff --git a/src/main/java/org/bukkit/event/entity/ArrowBodyCountChangeEvent.java b/src/main/java/org/bukkit/event/entity/ArrowBodyCountChangeEvent.java
new file mode 100644
index 0000000000000000000000000000000000000000..fd36e93fc3fe5156cbd5d86222bbc0e67a38b763
--- /dev/null
+++ b/src/main/java/org/bukkit/event/entity/ArrowBodyCountChangeEvent.java
@@ -0,0 +1,85 @@
+package org.bukkit.event.entity;
+
+import org.bukkit.entity.LivingEntity;
+import org.bukkit.event.Cancellable;
+import org.bukkit.event.HandlerList;
+
+/**
+ * Called when an arrow enters or exists an entity's body.
+ */
+public class ArrowBodyCountChangeEvent extends EntityEvent implements Cancellable {
+
+    private static final HandlerList handlers = new HandlerList();
+    private final int oldAmount;
+    private final boolean reset;
+    private int newAmount;
+    private boolean cancelled;
+
+    public ArrowBodyCountChangeEvent(LivingEntity entity, int oldAmount, int newAmount, boolean reset) {
+        super(entity);
+        this.oldAmount = oldAmount;
+        this.newAmount = newAmount;
+        this.reset = reset;
+    }
+
+    /**
+     * Whether the event was called because the entity was reset.
+     *
+     * @return was reset
+     */
+    public boolean isReset() {
+        return reset;
+    }
+
+    /**
+     * Gets the old amount of arrows in the entity's body.
+     *
+     * @return amount of arrows
+     */
+    public int getOldAmount() {
+        return oldAmount;
+    }
+
+    /**
+     * Get the new amount of arrows in the entity's body.
+     *
+     * @return amount of arrows
+     */
+    public int getNewAmount() {
+        return newAmount;
+    }
+
+    /**
+     * Sets the final amount of arrows in the entity's body.
+     *
+     * @param newAmount amount of arrows
+     */
+    public void setNewAmount(int newAmount) {
+        this.newAmount = newAmount;
+    }
+
+    @Override
+    public LivingEntity getEntity() {
+        return (LivingEntity) entity;
+    }
+
+    @Override
+    public boolean isCancelled() {
+        return cancelled;
+    }
+
+    @Override
+    public void setCancelled(boolean cancel) {
+        cancelled = cancel;
+    }
+
+    @Override
+    public HandlerList getHandlers() {
+        return handlers;
+    }
+
+    public static HandlerList getHandlerList() {
+        return handlers;
+    }
+
+}
